# WIP - 作業中のタスク

## 完了した機能

### 当日パビリオン予約ダイアログ ✅
- パビリオン検索ページでFABサブボタン押下により当日予約ダイアログを表示
- 万博API（expo.ebii.net/api/data）を利用してパビリオン情報を取得
- CORS対策として Chrome拡張機能とUserScript両方に対応

#### UI仕様 ✅
- **ヘッダー**: タイトル + 更新ボタン（右上）
- **制御エリア**: 空きのみトグルボタン（ON/OFF切り替え、色で状態表示）
- **パビリオンリスト**: 
  - 各アイテムに予約ボタン（空きなし時はdisabled）
  - 全体表示時に監視チェックボックス（左端配置）
  - アイテム全体クリックでチェック可能、チェック時は背景色変更
- **フッター**: 閉じるボタン + 空きのみボタン + 監視ボタン
- **ボタンスタイル統一**: 全ボタンが円形の洗練されたスタイル

#### 技術実装 ✅
- Chrome拡張機能: background service workerでAPI アクセス
- UserScript: GM_xmlhttpRequestでCORS回避
- 空きのみ/全体表示の切り替え機能
- パビリオン情報: 名前、時間枠（🟢空きあり 🟡残りわずか ⚪空きなし）、予約ボタン
- 監視チェックボックス機能（UI実装済み、機能は後日実装予定）

## 現在の作業

### 予約自動化機能の設計
パビリオン予約の自動化について以下の設計を検討中：

#### フロー設計
1. **予約開始**: パビリオン検索ページで時間指定 + 予約ボタン押下
2. **情報保存**: 予約情報をキャッシュ（localStorage/sessionStorage）に保存
3. **ページ遷移**: 予約ページに自動遷移
4. **操作復元**: キャッシュから情報を復元し、必要な操作を自動実行
5. **完了処理**: 予約完了またはエラー処理

#### 保存データ構造（案）
```javascript
{
  pavilionId: string,
  pavilionName: string,
  selectedTimeSlot: string,
  operationSteps: string[],
  timestamp: number
}
```

#### 技術課題
- 時間指定UI の実装方法
- DOM要素の特定方法（予約ページの構造解析必要）
- エラーハンドリング（DOM構造変化、ネットワークエラー等）
- 操作の信頼性確保

## 次のステップ
1. 時間指定UI の設計・実装
2. 予約ページのDOM構造調査
3. キャッシュ機能の実装
4. 自動操作ロジックの実装
5. エラーハンドリングの強化