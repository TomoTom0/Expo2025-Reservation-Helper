<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‡åšäºˆç´„è£œåŠ© - ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #006821, #02862b);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #006821;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-family: inherit;
        }
        .test-button:hover {
            background: #02862b;
        }
        .test-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .clear-btn {
            background: #666;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            float: right;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.pass { background: #d4edda; border-left: 5px solid #28a745; }
        .status.fail { background: #f8d7da; border-left: 5px solid #dc3545; }
        .status.warn { background: #fff3cd; border-left: 5px solid #ffc107; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¡ ä¸‡åšäºˆç´„è£œåŠ©ã‚·ã‚¹ãƒ†ãƒ </h1>
        <h2>ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ</h2>
        <p>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šä¸è¦ã§å®Ÿè¡Œå¯èƒ½ãªãƒ†ã‚¹ãƒˆé …ç›®</p>
    </div>

    <div class="test-section">
        <h3>ğŸ›ï¸ ãƒ‘ãƒ“ãƒªã‚ªãƒ³æ¤œç´¢ãƒ†ã‚¹ãƒˆ</h3>
        <p>prepare_filteré–¢æ•°ã®æ­£è¦è¡¨ç¾ç”Ÿæˆæ©Ÿèƒ½ï¼ˆAND/OR/ãƒã‚¤ãƒŠã‚¹æ¤œç´¢/ãƒ•ãƒ¬ãƒ¼ã‚ºæ¤œç´¢ï¼‰ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runPavilionTests()">ãƒ‘ãƒ“ãƒªã‚ªãƒ³æ¤œç´¢ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearOutput('pavilion-output')">ã‚¯ãƒªã‚¢</button>
        <div id="pavilion-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ” URLåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</h3>
        <p>ãƒ‘ãƒ“ãƒªã‚ªãƒ³äºˆç´„ã¨å…¥å ´äºˆç´„ã®URLè‡ªå‹•åˆ¤å®šæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runUrlTests()">URLåˆ¤å®šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearOutput('url-output')">ã‚¯ãƒªã‚¢</button>
        <div id="url-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>â±ï¸ ãƒ©ãƒ³ãƒ€ãƒ å¾…æ©Ÿæ™‚é–“ãƒ†ã‚¹ãƒˆ</h3>
        <p>BANå¯¾ç­–ç”¨ã®ãƒ©ãƒ³ãƒ€ãƒ å¾…æ©Ÿæ™‚é–“ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runTimingTests()">åŸºæœ¬ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="test-button" onclick="runBanAnalysis()">BANå¯¾ç­–åˆ†æ</button>
        <button class="clear-btn" onclick="clearOutput('timing-output')">ã‚¯ãƒªã‚¢</button>
        <div id="timing-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ¨ FAB UIæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h3>
        <p>å³ä¸‹å›ºå®šFABãƒœã‚¿ãƒ³ã®ä½œæˆãƒ»çŠ¶æ…‹ç®¡ç†ãƒ»ç›£è¦–å¯¾è±¡è¡¨ç¤ºæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runFabTests()">FAB UIãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearOutput('fab-output')">ã‚¯ãƒªã‚¢</button>
        <div id="fab-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å¤‰æ›´ç›£è¦–ãƒ†ã‚¹ãƒˆ</h3>
        <p>MutationObserverã«ã‚ˆã‚‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å¤‰æ›´æ¤œå‡ºãƒ»æ—¥ä»˜å¤‰æ›´å‡¦ç†ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runCalendarTests()">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç›£è¦–ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearOutput('calendar-output')">ã‚¯ãƒªã‚¢</button>
        <div id="calendar-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ’¾ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»æ°¸ç¶šåŒ–ãƒ†ã‚¹ãƒˆ</h3>
        <p>localStorageåŸºç›¤ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†ãƒ»ç›£è¦–å¯¾è±¡ä¿å­˜å¾©å…ƒæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runCacheTests()">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearOutput('cache-output')">ã‚¯ãƒªã‚¢</button>
        <div id="cache-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>âš™ï¸ è¨­å®šæ¤œè¨¼ãƒ†ã‚¹ãƒˆ</h3>
        <p>è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã¨ã‚»ãƒ¬ã‚¯ã‚¿ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runConfigTests()">è¨­å®šæ¤œè¨¼å®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearOutput('config-output')">ã‚¯ãƒªã‚¢</button>
        <div id="config-output" class="output"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ”„ å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</h3>
        <p>ã™ã¹ã¦ã®ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã‚’é †æ¬¡å®Ÿè¡Œã—ã¾ã™ã€‚</p>
        <button class="test-button" onclick="runAllTests()">å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button class="clear-btn" onclick="clearAllOutputs()">å…¨ã‚¯ãƒªã‚¢</button>
        <div id="summary-output" class="output"></div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®èª­ã¿è¾¼ã¿ -->
    <script src="pavilion-search-test.js"></script>
    <script src="url-detection-test.js"></script>
    <script src="random-timing-test.js"></script>
    <script src="fab-ui-test.js"></script>
    <script src="calendar-watcher-test.js"></script>
    <script src="cache-system-test.js"></script>
    <script src="config-validation-test.js"></script>

    <script>
        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã‚’ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function captureConsoleOutput(targetId, testFunction) {
            const originalLog = console.log;
            const output = document.getElementById(targetId);
            let logBuffer = '';

            console.log = function(...args) {
                const message = args.join(' ') + '\n';
                logBuffer += message;
                output.textContent = logBuffer;
                originalLog.apply(console, args);
            };

            try {
                const result = testFunction();
                return result;
            } finally {
                console.log = originalLog;
            }
        }

        // å€‹åˆ¥ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé–¢æ•°
        function runPavilionTests() {
            captureConsoleOutput('pavilion-output', runPavilionSearchTests);
        }

        function runUrlTests() {
            captureConsoleOutput('url-output', runUrlDetectionTests);
        }

        function runTimingTests() {
            captureConsoleOutput('timing-output', runRandomTimingTests);
        }

        function runBanAnalysis() {
            captureConsoleOutput('timing-output', analyzeBanProtection);
        }

        function runFabTests() {
            captureConsoleOutput('fab-output', runFabUITests);
        }

        function runCalendarTests() {
            captureConsoleOutput('calendar-output', runCalendarWatcherTests);
        }

        function runCacheTests() {
            captureConsoleOutput('cache-output', runCacheSystemTests);
        }

        function runConfigTests() {
            captureConsoleOutput('config-output', runConfigValidationTests);
        }

        // å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        function runAllTests() {
            const summaryOutput = document.getElementById('summary-output');
            summaryOutput.textContent = 'ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...\n';

            setTimeout(() => {
                const results = {
                    pavilion: captureConsoleOutput('pavilion-output', runPavilionSearchTests),
                    url: captureConsoleOutput('url-output', runUrlDetectionTests),
                    timing: captureConsoleOutput('timing-output', runRandomTimingTests),
                    fab: captureConsoleOutput('fab-output', runFabUITests),
                    calendar: captureConsoleOutput('calendar-output', runCalendarWatcherTests),
                    cache: captureConsoleOutput('cache-output', runCacheSystemTests),
                    config: captureConsoleOutput('config-output', runConfigValidationTests)
                };

                let summary = '=== å…¨ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼ ===\n\n';
                
                if (results.pavilion) {
                    summary += `ãƒ‘ãƒ“ãƒªã‚ªãƒ³æ¤œç´¢ãƒ†ã‚¹ãƒˆ: ${results.pavilion.passed}/${results.pavilion.total} æˆåŠŸ (${((results.pavilion.passed/results.pavilion.total)*100).toFixed(1)}%)\n`;
                }
                
                if (results.url) {
                    summary += `URLåˆ¤å®šãƒ†ã‚¹ãƒˆ: ${results.url.passCount}/${results.url.total} æˆåŠŸ (${((results.url.passCount/results.url.total)*100).toFixed(1)}%)\n`;
                }
                
                if (results.fab) {
                    summary += `FAB UIãƒ†ã‚¹ãƒˆ: ${results.fab.passed}/${results.fab.total} æˆåŠŸ (${((results.fab.passed/results.fab.total)*100).toFixed(1)}%)\n`;
                }
                
                if (results.calendar) {
                    // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆã¯ Promise ã‚’è¿”ã™ã®ã§ç‰¹åˆ¥æ‰±ã„
                    summary += `ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç›£è¦–ãƒ†ã‚¹ãƒˆ: å®Ÿè¡Œå®Œäº†\n`;
                }
                
                if (results.cache) {
                    summary += `ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: ${results.cache.passed}/${results.cache.total} æˆåŠŸ (${((results.cache.passed/results.cache.total)*100).toFixed(1)}%)\n`;
                }
                
                if (results.config) {
                    summary += `è¨­å®šæ¤œè¨¼: ${results.config.isValid ? 'âœ… æœ‰åŠ¹' : 'âŒ ç„¡åŠ¹'} (ã‚¨ãƒ©ãƒ¼${results.config.errors.length}ä»¶, è­¦å‘Š${results.config.warnings.length}ä»¶)\n`;
                }
                
                summary += '\nãƒ©ãƒ³ãƒ€ãƒ å¾…æ©Ÿæ™‚é–“ãƒ†ã‚¹ãƒˆ: å®Œäº†\n';
                summary += '\nå…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå®Œäº†ï¼';

                summaryOutput.textContent = summary;
            }, 100);
        }

        // å‡ºåŠ›ã‚¯ãƒªã‚¢
        function clearOutput(id) {
            document.getElementById(id).textContent = '';
        }

        function clearAllOutputs() {
            ['pavilion-output', 'url-output', 'timing-output', 'fab-output', 'calendar-output', 'cache-output', 'config-output', 'summary-output'].forEach(clearOutput);
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã®å‡¦ç†
        window.onload = function() {
            console.log('ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
            console.log('å„ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„');
        };
    </script>
</body>
</html>